{% extends 'base.html' %}

{% block title %}{{ article.title }} - Mela-Med Aesthetic{% endblock %}

{% block content %}
<!-- Hero секція статті -->
<div class="article-hero">
    <div class="article-hero-overlay"></div>
    <div class="article-hero-image {% if not article.image %}no-image{% endif %}" 
         {% if article.image %}style="background-image: url('{{ article.image.url }}');"{% endif %}></div>
    <div class="container">
        <div class="article-hero-content animate-on-scroll">
            <div class="article-meta-header">
                <span class="article-date">
                    <i class="far fa-calendar-alt"></i>
                    {{ article.created_at|date:"d M Y" }}
                </span>
                <span class="article-reading-time">
                    <i class="far fa-clock"></i>
                    5 хв читання
                </span>
            </div>
            <h1 class="article-title">{{ article.title }}</h1>
            <div class="article-tags-hero">
                {% for tag in article.tags.all %}
                <a href="{% url 'articles_list' %}?tag={{ tag.slug }}" class="tag-hero">#{{ tag.name }}</a>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- Контент статті -->
<div class="container">
    <div class="article-layout">
        <!-- Основний контент -->
        <article class="article-content animate-on-scroll">
            <div class="article-body">
                {{ article.content|safe }}
            </div>

            <!-- Соціальний шеринг -->
            <div class="article-share">
                <h3>Поділитися статтею</h3>
                <div class="share-buttons">
                    <button class="share-btn share-facebook" onclick="shareArticle('facebook')">
                        <i class="fab fa-facebook-f"></i>
                        Facebook
                    </button>
                    <button class="share-btn share-telegram" onclick="shareArticle('telegram')">
                        <i class="fab fa-telegram"></i>
                        Telegram
                    </button>
                    <button class="share-btn share-copy" onclick="copyLink()">
                        <i class="fas fa-link"></i>
                        Копіювати
                    </button>
                </div>
            </div>

            <!-- Теги статті -->
            <div class="article-tags-footer">
                <strong>Теги:</strong>
                {% for tag in article.tags.all %}
                <a href="{% url 'articles_list' %}?tag={{ tag.slug }}" class="tag-link">#{{ tag.name }}</a>
                {% if not forloop.last %}, {% endif %}
                {% endfor %}
            </div>
        </article>

        <!-- Бокова панель -->
        <aside class="article-sidebar">
            <!-- Про нас -->
            <div class="sidebar-card animate-on-scroll">
                <div class="sidebar-icon">
                    <i class="fas fa-spa"></i>
                </div>
                <h3>Про Mela-Med Aesthetic</h3>
                <p>Гармонія вашої краси — наш головний пріоритет. Надаємо послуги преміум-класу з використанням інноваційних технологій.</p>
                <a href="{% url 'contacts' %}" class="sidebar-btn">
                    Зв'язатися з нами
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <!-- Популярні статті -->
            {% if related_articles %}
            <div class="sidebar-card animate-on-scroll">
                <h3>Схожі статті</h3>
                <div class="related-articles">
                    {% for related in related_articles %}
                    <a href="{% url 'article_detail' related.slug %}" class="related-article-item">
                        <div class="related-article-image {% if not related.image %}no-image{% endif %}"
                             {% if related.image %}style="background-image: url('{{ related.image.url }}');"{% endif %}></div>
                        <div class="related-article-content">
                            <h4>{{ related.title|truncatewords:8 }}</h4>
                            <span class="related-date">{{ related.created_at|date:"d M Y" }}</span>
                        </div>
                    </a>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- CTA блок -->
            <div class="sidebar-card sidebar-cta animate-on-scroll">
                <div class="cta-icon">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <h3>Готові до перетворення?</h3>
                <p>Запишіться на консультацію та отримайте індивідуальну програму догляду</p>
                <a href="{% url 'procedure_types_list' %}" class="btn btn-primary">
                    Переглянути процедури
                </a>
            </div>
        </aside>
    </div>

    <!-- Навігація між статтями -->
    <div class="article-navigation">
        {% if previous_article %}
        <a href="{% url 'article_detail' previous_article.slug %}" class="nav-article nav-prev">
            <span class="nav-label">
                <i class="fas fa-arrow-left"></i>
                Попередня стаття
            </span>
            <span class="nav-title">{{ previous_article.title|truncatewords:8 }}</span>
        </a>
        {% else %}
        <div class="nav-article nav-disabled"></div>
        {% endif %}

        <a href="{% url 'articles_list' %}" class="nav-all-articles">
            <i class="fas fa-th"></i>
            Всі статті
        </a>

        {% if next_article %}
        <a href="{% url 'article_detail' next_article.slug %}" class="nav-article nav-next">
            <span class="nav-label">
                Наступна стаття
                <i class="fas fa-arrow-right"></i>
            </span>
            <span class="nav-title">{{ next_article.title|truncatewords:8 }}</span>
        </a>
        {% else %}
        <div class="nav-article nav-disabled"></div>
        {% endif %}
    </div>
</div>

<style>
/* Hero секція статті */
.article-hero {
    position: relative;
    height: 500px;
    display: flex;
    align-items: center;
    margin-bottom: 60px;
    overflow: hidden;
}

.article-hero-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    animation: kenBurns 20s ease-out infinite alternate;
}

@keyframes kenBurns {
    0% { transform: scale(1); }
    100% { transform: scale(1.1); }
}

.article-hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(212, 165, 165, 0.9) 0%, rgba(160, 120, 120, 0.85) 100%);
    z-index: 1;
}

.article-hero-content {
    position: relative;
    z-index: 2;
    max-width: 900px;
}

.article-meta-header {
    display: flex;
    gap: 25px;
    margin-bottom: 20px;
    font-size: 0.95rem;
    color: rgba(255, 255, 255, 0.9);
}

.article-meta-header span {
    display: flex;
    align-items: center;
    gap: 8px;
}

.article-meta-header i {
    font-size: 1.1rem;
}

.article-title {
    font-family: 'Playfair Display', serif;
    font-size: 3.2rem;
    color: white;
    margin-bottom: 25px;
    line-height: 1.3;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.article-tags-hero {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.tag-hero {
    padding: 8px 18px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    border-radius: 30px;
    font-size: 0.9rem;
    text-decoration: none;
    transition: all 0.3s;
}

.tag-hero:hover {
    background: white;
    color: var(--accent);
    transform: translateY(-2px);
}

/* Лейаут статті */
.article-layout {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 50px;
    margin-bottom: 60px;
}

/* Контент статті */
.article-content {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 50px;
}

.article-body {
    font-size: 1.1rem;
    line-height: 1.9;
    color: var(--dark);
}

.article-body p {
    margin-bottom: 20px;
}

.article-body h2 {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    color: var(--accent);
    margin: 40px 0 20px;
}

.article-body h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    color: var(--accent);
    margin: 30px 0 15px;
}

.article-body ul,
.article-body ol {
    margin: 20px 0 20px 30px;
}

.article-body li {
    margin-bottom: 10px;
}

.article-body img {
    max-width: 100%;
    border-radius: var(--radius);
    margin: 30px 0;
    box-shadow: var(--shadow);
}

.article-body blockquote {
    border-left: 4px solid var(--accent);
    padding: 20px 30px;
    margin: 30px 0;
    background: var(--secondary);
    border-radius: 0 var(--radius) var(--radius) 0;
    font-style: italic;
    color: var(--dark);
}

/* Шеринг */
.article-share {
    margin-top: 50px;
    padding-top: 40px;
    border-top: 2px solid var(--secondary);
}

.article-share h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    margin-bottom: 20px;
    color: var(--accent);
}

.share-buttons {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.share-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    border: none;
    border-radius: 30px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.95rem;
}

.share-facebook {
    background: #1877f2;
    color: white;
}

.share-telegram {
    background: #0088cc;
    color: white;
}

.share-copy {
    background: var(--secondary);
    color: var(--accent);
}

.share-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

/* Теги футера */
.article-tags-footer {
    margin-top: 40px;
    padding-top: 30px;
    border-top: 2px solid var(--secondary);
    font-size: 1rem;
    color: var(--dark);
}

.tag-link {
    color: var(--accent);
    text-decoration: none;
    transition: opacity 0.3s;
}

.tag-link:hover {
    opacity: 0.7;
}

/* Бокова панель */
.sidebar-card {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 30px;
    margin-bottom: 30px;
    transition: transform 0.3s;
}

.sidebar-card:hover {
    transform: translateY(-5px);
}

.sidebar-card h3 {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem;
    margin-bottom: 15px;
    color: var(--accent);
}

.sidebar-icon {
    width: 60px;
    height: 60px;
    background: var(--gradient);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 20px;
    font-size: 1.8rem;
    color: white;
}

.sidebar-card p {
    color: var(--dark);
    opacity: 0.85;
    line-height: 1.7;
    margin-bottom: 20px;
}

.sidebar-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    color: var(--accent);
    text-decoration: none;
    font-weight: 600;
    transition: gap 0.3s;
}

.sidebar-btn:hover {
    gap: 12px;
}

/* Схожі статті */
.related-articles {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.related-article-item {
    display: flex;
    gap: 15px;
    text-decoration: none;
    color: inherit;
    padding: 12px;
    border-radius: var(--radius);
    transition: all 0.3s;
}

.related-article-item:hover {
    background: var(--secondary);
    transform: translateX(5px);
}

.related-article-image {
    width: 80px;
    height: 80px;
    flex-shrink: 0;
    border-radius: var(--radius);
    background-size: cover;
    background-position: center;
}

.related-article-content h4 {
    font-size: 1rem;
    margin-bottom: 5px;
    color: var(--dark);
    line-height: 1.4;
}

.related-date {
    font-size: 0.85rem;
    color: var(--accent);
    opacity: 0.8;
}

/* CTA блок */
.sidebar-cta {
    background: var(--gradient);
    color: white;
    text-align: center;
}

.sidebar-cta h3,
.sidebar-cta p {
    color: white;
}

.cta-icon {
    width: 70px;
    height: 70px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 20px;
    font-size: 2rem;
}

.sidebar-cta .btn-primary {
    background: white;
    color: var(--accent);
    margin-top: 20px;
}

/* Навігація між статтями */
.article-navigation {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 20px;
    margin: 60px 0;
    align-items: center;
}

.nav-article {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    padding: 25px;
    text-decoration: none;
    color: inherit;
    transition: all 0.3s;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.nav-article:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(212, 165, 165, 0.25);
}

.nav-prev {
    text-align: left;
}

.nav-next {
    text-align: right;
}

.nav-label {
    font-size: 0.9rem;
    color: var(--accent);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
}

.nav-next .nav-label {
    justify-content: flex-end;
}

.nav-title {
    font-size: 1.1rem;
    color: var(--dark);
}

.nav-disabled {
    opacity: 0;
    pointer-events: none;
}

.nav-all-articles {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 20px;
    background: var(--secondary);
    border-radius: 50%;
    width: 80px;
    height: 80px;
    justify-content: center;
    text-decoration: none;
    color: var(--accent);
    font-weight: 600;
    font-size: 0.85rem;
    transition: all 0.3s;
}

.nav-all-articles:hover {
    background: var(--accent);
    color: white;
    transform: scale(1.1);
}

.nav-all-articles i {
    font-size: 1.3rem;
}

/* Адаптивність */
@media (max-width: 992px) {
    .article-layout {
        grid-template-columns: 1fr;
    }

    .article-navigation {
        grid-template-columns: 1fr;
        gap: 15px;
    }

    .nav-all-articles {
        width: 100%;
        height: auto;
        border-radius: var(--radius);
        flex-direction: row;
    }
}

@media (max-width: 768px) {
    .article-hero {
        height: 400px;
    }

    .article-title {
        font-size: 2.2rem;
    }

    .article-content {
        padding: 30px 20px;
    }

    .article-body {
        font-size: 1rem;
    }

    .share-buttons {
        flex-direction: column;
    }

    .share-btn {
        width: 100%;
        justify-content: center;
    }
}
</style>

<script>
// Функція для шерингу
function shareArticle(platform) {
    const url = window.location.href;
    const title = document.querySelector('.article-title').textContent;
    
    let shareUrl;
    
    switch(platform) {
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
            break;
        case 'telegram':
            shareUrl = `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
            break;
    }
    
    if (shareUrl) {
        window.open(shareUrl, '_blank', 'width=600,height=400');
    }
}

// Функція копіювання посилання
function copyLink() {
    const url = window.location.href;
    const btn = event.target.closest('.share-copy');
    
    navigator.clipboard.writeText(url).then(() => {
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> Скопійовано!';
        btn.style.background = '#4caf50';
        btn.style.color = 'white';
        
        setTimeout(() => {
            btn.innerHTML = originalText;
            btn.style.background = '';
            btn.style.color = '';
        }, 2000);
    });
}

// Плавна поява елементів при скролі
document.addEventListener('DOMContentLoaded', function() {
    const animateElements = document.querySelectorAll('.animate-on-scroll');
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('animated');
            }
        });
    }, {
        threshold: 0.1
    });
    
    animateElements.forEach(el => observer.observe(el));
});
</script>
{% endblock %}